# 幾何物件與運算整理

## 1. 幾何定義與數學背景

### 點 (Point)
- 在二維空間中，點表示一個位置，**沒有長、寬、高**。
- 通常以座標表示：  
  $$
  P = (x, y)
  $$

### 線 (Line)
- 點的無限集合，在一個維度上無限延伸。
- 程式中常用一般式表示：
  $$
  Ax + By + C = 0
  $$
  可以處理鉛直線（斜率不存在）的情況。

### 圓 (Circle)
- 與定點（圓心）等距離（半徑）的所有點的集合。
- 方程式：
  $$
  (x - h)^2 + (y - k)^2 = r^2
  $$

### 交點數學原理

#### 兩直線交點
- 求解聯立方程組：
  $$
  \begin{cases}
  A_1 x + B_1 y + C_1 = 0 \\
  A_2 x + B_2 y + C_2 = 0
  \end{cases}
  $$
- 若 $A_1 B_2 - A_2 B_1 = 0$，則兩線平行。

#### 直線與圓交點
- 將直線方程式代入圓方程式，得到二次方程：
  $$
  ax^2 + bx + c = 0
  $$
- 透過判別式判斷交點數量：
  $$
  D = b^2 - 4ac \quad \Rightarrow \quad 0, 1, \text{或} 2 \text{個交點}
  $$

#### 兩圓交點
- 將兩個圓方程相減，可得到一條直線（連心線的垂線，稱為根軸），再計算該直線與其中一圓的交點。

---

## 2. 幾何物件與運算 Python 實作

```python
import math

class Point:
    def __init__(self, x, y):
        self.x = x
        self.y = y

    def __repr__(self):
        return f"Point({self.x:.2f}, {self.y:.2f})"

class Line:
    """一般式 Ax + By + C = 0"""
    def __init__(self, A, B, C):
        self.A = A
        self.B = B
        self.C = C

    @classmethod
    def from_points(cls, p1, p2):
        A = p1.y - p2.y
        B = p2.x - p1.x
        C = p1.x * p2.y - p2.x * p1.y
        return cls(A, B, C)

class Circle:
    def __init__(self, center, r):
        self.center = center
        self.r = r

def intersect_lines(l1, l2):
    det = l1.A * l2.B - l2.A * l1.B
    if abs(det) < 1e-9: return None  # 平行
    x = (l1.B * l2.C - l2.B * l1.C) / det
    y = (l2.A * l1.C - l1.A * l2.C) / det
    return Point(x, y)

def intersect_line_circle(line, circle):
    h, k = circle.center.x, circle.center.y
    r = circle.r
    C_prime = line.A * h + line.B * k + line.C
    A, B = line.A, line.B
    dist_sq = C_prime**2 / (A**2 + B**2)
    if dist_sq > r**2 + 1e-9: return [] # 無交點

    x0 = -A * C_prime / (A**2 + B**2)
    y0 = -B * C_prime / (A**2 + B**2)

    if abs(dist_sq - r**2) < 1e-9: # 切點
        return [Point(x0 + h, y0 + k)]

    d = math.sqrt((r**2 - dist_sq) / (A**2 + B**2))
    return [
        Point(x0 + B*d + h, y0 - A*d + k),
        Point(x0 - B*d + h, y0 + A*d + k)
    ]
